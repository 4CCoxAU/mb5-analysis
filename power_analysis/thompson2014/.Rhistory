knitr::opts_chunk$set(echo = TRUE,warning=FALSE, message = FALSE)
library(tidyverse)
library(tidyverse)
library(here)
d <- read_csv(here("power_analysis","thompson2014","dfthomspon2014.trialdata.csv"))
d <- read_csv(here("power_analysis","thompson2014","dfthompson2014.trialdata.csv"))
?pivot_longer
d <- d %>%
pivot_wider(
cols=c("novel","familiar"),
names_to = "stimulus_type",
values_to = "looking_time"
) %>%
mutate(
looking_time_s = looking_time * 0.1
)
d <- d %>%
pivot_longer(
cols=c("novel","familiar"),
names_to = "stimulus_type",
values_to = "looking_time"
) %>%
mutate(
looking_time_s = looking_time * 0.1
)
d <- read_csv(here("power_analysis","thompson2014","dfthompson2014.trialdata.csv"))
d <- d %>%
pivot_longer(
cols=c("novel","famil"),
names_to = "stimulus_type",
values_to = "looking_time"
) %>%
mutate(
looking_time_s = looking_time * 0.1
)
View(d)
ggplot(d,aes(looking_time_s,color=stimulus_type,group=stimulus_type))+
geom_histogram()
ggplot(d,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram(alpha=0.1)
ggplot(d,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram()+
facet_wrap(~stimulus_type)
ggplot(d,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram()+
geom_density()+
facet_wrap(~stimulus_type)
geom_density()
?geom_density
ggplot(d,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram()+
geom_density(adjust=300)+
facet_wrap(~stimulus_type)
ggplot(d,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram()+
facet_wrap(~stimulus_type)+
theme(legend.position="none")
View(d)
d_long <- d %>%
pivot_longer(
cols=c("novel","famil"),
names_to = "stimulus_type",
values_to = "looking_time"
) %>%
mutate(
looking_time_s = looking_time * 0.1
)
```{r}
d <- read_csv(here("power_analysis","thompson2014","dfthompson2014.trialdata.csv"))
d_long <- d %>%
pivot_longer(
cols=c("novel","famil"),
names_to = "stimulus_type",
values_to = "looking_time"
) %>%
mutate(
looking_time_s = looking_time * 0.1
)
ggplot(d_long,aes(looking_time_s,fill=stimulus_type,group=stimulus_type))+
geom_histogram()+
facet_wrap(~stimulus_type)+
theme(legend.position="none")
View(d)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel)
)
View(avg_noveltypref_subj_by_trial)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)
)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref),
novelty_preference_se=qt(0.975, N-1)*sd(dprime,na.rm=T)/sqrt(N)
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref),
novelty_preference_se=qt(0.975, N-1)*sd(novelty_pref,na.rm=T)/sqrt(N)
)
View(avg_noveltypref_by_trial)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
novelty_preference_se=qt(0.975, N-1)*sd(novelty_pref,na.rm=T)/sqrt(N)
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
novelty_preference_se=qt(0.975, N-1)*sd(novelty_pref,na.rm=TRUE)/sqrt(N)
)
ggplot(avg_noveltypref_by_trial,aes(trnum,novelty_preference))+
geom_line()+
geom_errorbar(aes(ymin=novelty_preference-se,ymax=novelty_preference+se),width=0)+
geom_point(size=1.5)+
geom_hline(yintercept=0.5,linetype="dashed")
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
se=qt(0.975, N-1)*sd(novelty_pref,na.rm=TRUE)/sqrt(N)
)
ggplot(avg_noveltypref_by_trial,aes(trnum,novelty_preference))+
geom_line()+
geom_errorbar(aes(ymin=novelty_preference-se,ymax=novelty_preference+se),width=0)+
geom_point(size=1.5)+
geom_hline(yintercept=0.5,linetype="dashed")
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)*.01
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
se=qt(0.975, N-1)*sd(novelty_pref,na.rm=TRUE)/sqrt(N)
)
ggplot(avg_noveltypref_by_trial,aes(trnum,novelty_preference))+
geom_line()+
geom_errorbar(aes(ymin=novelty_preference-se,ymax=novelty_preference+se),width=0)+
geom_point(size=1.5)+
geom_hline(yintercept=0.5,linetype="dashed")
mean(avg_noveltypref_by_trial$novelty_preference)
se(avg_noveltypref_by_trial$novelty_preference)
sd(avg_noveltypref_by_trial$novelty_preference)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)*.01,
avg_novel_looking_time_s = mean(novel)*0.1,
avg_fam_looking_time_s = mean(familiar) * 0.1
)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)*.01,
avg_novel_looking_time_s = mean(novel)*0.1,
avg_fam_looking_time_s = mean(famil) * 0.1
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
se=qt(0.975, N-1)*sd(novelty_pref,na.rm=TRUE)/sqrt(N),
novel_looking_time_s = mean(avg_novel_looking_time_s),
fam_looking_time_s = mean(avg_fam_looking_time_s)
)
ggplot(avg_noveltypref_by_trial,aes(trnum,novelty_preference))+
geom_line()+
geom_errorbar(aes(ymin=novelty_preference-se,ymax=novelty_preference+se),width=0)+
geom_point(size=1.5)+
geom_hline(yintercept=0.5,linetype="dashed")
ggplot(avg_noveltypref_by_trial,aes(trnum,novel_looking_time_s))+
geom_line(color="blue")+
geom_point(size=1.5,color="blue")+
geom_line(color="red")+
geom_point(size=1.5,color="red")
ggplot(avg_noveltypref_by_trial,aes(trnum,novel_looking_time_s))+
geom_line(color="blue")+
geom_point(size=1.5,color="blue")+
geom_line(aes(y=familiar_looking_time_s),color="red")+
geom_point(aes(y=familiar_looking_time_s),size=1.5,color="red")
ggplot(avg_noveltypref_by_trial,aes(trnum,novel_looking_time_s))+
geom_line(color="blue")+
geom_point(size=1.5,color="blue")+
geom_line(aes(y=fam_looking_time_s),color="red")+
geom_point(aes(y=fam_looking_time_s),size=1.5,color="red")
View(d)
View(d)
18*30
## session based
ggplot(d_long,aes(trnum,y=pctnovel,color=id)) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_hline(yintercept=50,linetype="dashed")
## session based
ggplot(d_long,aes(trnum,y=pctnovel,color=id,group=id)) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_hline(yintercept=50,linetype="dashed")
## session based
ggplot(d_long,aes(trnum,y=pctnovel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_hline(yintercept=50,linetype="dashed")
## session based
ggplot(d_long,aes(trnum,y=pctnovel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_hline(yintercept=50,linetype="dashed")+
facet_wrap(~id)
## session based
ggplot(d_long,aes(trnum,y=pctnovel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_hline(yintercept=50,linetype="dashed")+
facet_wrap(~VISIT)
## session based
ggplot(d_long,aes(trnum,y=fam_looking_time_s,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
facet_wrap(~VISIT)
## session based
ggplot(d_long,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
facet_wrap(~VISIT)
View(d_long)
## session based
ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
facet_wrap(~VISIT)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
facet_wrap(~VISIT)
n
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")
facet_wrap(~VISIT)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)
library(cowplot)
plot_grid(f,n)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)
plot_grid(f,n)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)
plot_grid(f,n)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)
plot_grid(f,n)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
ylim(0,125)
n
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
ylim(0,125)
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
ylim(0,125)
plot_grid(f,n)
?coord_cartesian
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(xlim=0,ylim=125)
n
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
plot_grid(f,n)
ggplot(avg_noveltypref_by_trial,aes(trnum,novel_looking_time_s))+
geom_line(color="blue")+
geom_point(size=1.5,color="blue")+
geom_line(aes(y=fam_looking_time_s),color="red")+
geom_point(aes(y=fam_looking_time_s),size=1.5,color="red")
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F,method="lm")+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
plot_grid(f,n)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
# geom_line(alpha=0.2)+
# geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
#geom_line(alpha=0.2)+
#geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
plot_grid(f,n)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
plot_grid(f,n)
## session based
f <- ggplot(d,aes(trnum,y=famil,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
n <- ggplot(d,aes(trnum,y=novel,color=as.factor(id),group=as.factor(id))) +
geom_line(alpha=0.2)+
geom_point(size=1.5,alpha=0.2)+
geom_smooth(alpha=0.2,se=F)+
theme(legend.position="none")+
facet_wrap(~VISIT)+
coord_cartesian(ylim=c(0,125))
plot_grid(f,n)
#summarize looking within subjects across session
avg_noveltypref_subj_by_trial <- d %>%
group_by(id,trnum) %>%
summarize(
novelty_pref=mean(pctnovel, na.rm=TRUE)*.01,
avg_novel_looking_time_s = mean(novel)*0.1,
avg_fam_looking_time_s = mean(famil) * 0.1
)
#summarize across subjects
avg_noveltypref_by_trial <- avg_noveltypref_subj_by_trial %>%
group_by(trnum) %>%
summarize(
N=n(),
novelty_preference=mean(novelty_pref,na.rm=TRUE),
se=qt(0.975, N-1)*sd(novelty_pref,na.rm=TRUE)/sqrt(N),
novel_looking_time_s = mean(avg_novel_looking_time_s),
fam_looking_time_s = mean(avg_fam_looking_time_s)
)
ggplot(avg_noveltypref_by_trial,aes(trnum,novelty_preference))+
geom_line()+
geom_errorbar(aes(ymin=novelty_preference-se,ymax=novelty_preference+se),width=0)+
geom_point(size=1.5)+
geom_hline(yintercept=0.5,linetype="dashed")
View(d)
